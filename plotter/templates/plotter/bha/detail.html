{# templates/plotter/bha/detail.html #}
{% extends 'plotter/bha/base_bha.html' %}

{% block bha_content %}
<div class="row">
    <div class="col-md-12 mb-4">
        <div class="designer-header">
            <h2 class="mb-2"><i class="bi bi-pencil-square me-2"></i>{{ bha.name }}</h2>
        </div>
    </div>
</div>

<div class="row">
    <!-- Left Column: Information -->
    <div class="col-lg-8">
        <!-- Summary Cards -->
        <div class="row mb-4">
            <div class="col-md-6 mb-3">
                <div class="card stats-card">
                    <div class="card-body">
                        <h6 class="card-title text-muted">Well Name</h6>
                        <h4 class="card-text mb-1">{{ bha.drilling_report.well.name }}</h4>
                        <small class="text-muted">{{ bha.drilling_report.date|date:"Y-m-d" }}</small>
                    </div>
                </div>
            </div>
            <div class="col-md-6 mb-3">
                <div class="card stats-card">
                    <div class="card-body">
                        <h6 class="card-title text-muted">Total Length</h6>
                        <h4 class="card-text mb-1">{{ bha.total_length|floatformat:2 }} m</h4>
                        <small class="text-muted">Total assembly length</small>
                    </div>
                </div>
            </div>
            <div class="col-md-6 mb-3">
                <div class="card stats-card">
                    <div class="card-body">
                        <h6 class="card-title text-muted">Total Weight</h6>
                        <h4 class="card-text mb-1">{{ bha.total_weight|floatformat:2 }} kg</h4>
                        <small class="text-muted">Total assembly weight</small>
                    </div>
                </div>
            </div>
            <div class="col-md-6 mb-3">
                <div class="card stats-card">
                    <div class="card-body">
                        <h6 class="card-title text-muted">Status</h6>
                        <h4 class="card-text mb-1">
                            {% if bha.is_active %}
                            <span class="badge bg-success">Active</span>
                            {% else %}
                            <span class="badge bg-secondary">Inactive</span>
                            {% endif %}
                        </h4>
                        <small class="text-muted">Current state</small>
                    </div>
                </div>
            </div>
        </div>

        <!-- Components Table -->
        <div class="card">
            <div class="card-header text-white" style="background-color: #1353A3;">
                <div class="d-flex justify-content-between align-items-center">
                    <h5 class="mb-0" style="font-weight:700;">
                        <i class="bi bi-list-check me-2"></i>Components
                    </h5>
                    <div>
                        <a href="{% url 'bha_edit_designer' bha.id %}" class="btn btn-light btn-sm">
                            <i class="bi bi-pencil-square me-1"></i>Edit / Add Components
                        </a>
                        <a href="{% url 'bha_export_pdf' bha.id %}" class="btn btn-outline-secondary btn-sm ms-2">
                            <i class="bi bi-filetype-pdf me-1"></i>Export PDF
                        </a>
                    </div>
                </div>
            </div>
            <div class="card-body">
                <div class="table-responsive">
                    <table class="table table-hover table-sm">
                        <thead>
                            <tr>
                                <th>Pos</th>
                                <th>Component</th>
                                <th>Type</th>
                                <th>Length (m)</th>
                                <th>OD (in)</th>
                                <th>From Bit (m)</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for component in components %}
                            <tr>
                                <td>{{ component.position }}</td>
                                <td><strong>{{ component.component.name }}</strong></td>
                                <td><small>{{ component.component.get_type_display }}</small></td>
                                <td>{{ component.length|floatformat:2 }}</td>
                                <td>{{ component.outer_diameter|floatformat:2 }}</td>
                                <td>{{ component.distance_from_bit|floatformat:2 }}</td>
                            </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>

    {% include 'plotter/bha/_bha_visualization.html' with mode='a4' bha=bha components=components total_length=total_length only %}
</div>



{% block extra_css %}
<style>
    :root {
        --primary-color: #1353A3;
        --border-radius: 8px;
    }

    .designer-header {
        background: linear-gradient(135deg, var(--primary-color) 0%, #0d3d73 100%);
        color: white;
        padding: 1rem;
        border-radius: var(--border-radius);
        box-shadow: 0 4px 6px rgba(0,0,0,0.1);
    }
</style>
{{ block.super }}
{% endblock %}

{% block extra_js %}
{{ block.super }}
{% endblock %}

{% endblock %}