<aside class="col-lg-3 col-xl-3">
    {% if prognosis_segments %}
    <div class="position-sticky" style="top: 0.8rem;">
        <div class="card">
            <div class="card-body">
                <div class="d-flex justify-content-between align-items-center mb-2">
                    <h6 class="mb-0" style="color: #257358; font-weight: 600;">
                        <i class="bi bi-layers me-1"></i>Prognosis Lithology
                    </h6>
                    {% if prognosis_range %}
                    <span class="text-muted" style="font-size: 0.8rem;">{{ prognosis_range.min }} - {{ prognosis_range.max }} m</span>
                    {% endif %}
                </div>
                <div class="prognosis-legend mb-2">
                    <span class="legend-item"><span class="legend-color" style="background:#FFD700;"></span> Sand</span>
                    <span class="legend-item"><span class="legend-color" style="background:#CD853F;"></span> Clay</span>
                    <span class="legend-item"><span class="legend-color" style="background:#666666;"></span> Shale</span>
                    <span class="legend-item"><span class="legend-color" style="background:#DEB887;"></span> Silt</span>
                    <span class="legend-item"><span class="legend-color" style="background:#a10c07;"></span> Target</span>
                </div>
                <div class="prognosis-wrap" id="prognosis-wrap">
                    <div class="prognosis-bar-v" aria-label="Prognosis lithology by depth (vertical)" id="prognosis-bar"{% if stats and stats.latest_depth %} data-latest-depth="{{ stats.latest_depth }}"{% endif %}>
                        {% if prognosis_range and prognosis_range.top_spacer_pct and prognosis_range.top_spacer_pct > 0 %}
                            <div class="prognosis-spacer" data-height="{{ prognosis_range.top_spacer_pct }}"></div>
                        {% endif %}
                        {% for seg in prognosis_segments %}
                            <div class="prognosis-segment {% if seg.is_target %}prognosis-target{% endif %}"
                                 data-from="{{ seg.from }}" data-to="{{ seg.to }}"
                                 data-height="{{ seg.height_pct }}"
                                 data-color="{% if seg.is_target %}#a10c07{% elif seg.lithology == 'sand' %}#FFD700{% elif seg.lithology == 'clay' %}#CD853F{% elif seg.lithology == 'shale' %}#666666{% elif seg.lithology == 'slit' or seg.lithology == 'silt' %}#DEB887{% else %}#9aa0a6{% endif %}"
                                 data-tooltip="{{ seg.label }} â€¢ {{ seg.lithology|title }}">
                            </div>
                        {% endfor %}
                    </div>
                    {% if prognosis_range %}
                    <div class="prognosis-depth-labels-v" aria-hidden="true" id="prognosis-ticks"
                         data-min="{{ prognosis_range.min }}" data-max="{{ prognosis_range.max }}">
                    </div>
                    {% endif %}
                </div>
            </div>
        </div>
    </div>
    {% endif %}
</aside>